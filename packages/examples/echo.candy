# Echoes whatever you send to it on stdin.

core = use "...Core"
async = core.async
await = core.await
channel = core.channel
run = core.function.run
text = core.text

main := { environment ->
  print message =
    needs (text.is message)
    environment.stdout | channel.send message

  read = {
    response = channel.create 1
    environment.stdin | channel.send response.sendPort
    await response.receivePort
  }

  print "Hello, world!"
  foo = run read
  print "Echo:"
  print foo
}
