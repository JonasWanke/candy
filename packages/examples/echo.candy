# Echoes whatever you send to it on stdin.

[async, await, channel, function, text] = use "...Core"

main := { environment ->
  print message =
    needs (text.is message)
    environment.stdout | channel.send message

  read = {
    response = channel.create 1
    environment.stdin | channel.send response.sendPort
    await response.receivePort
  }

  print "Hello, world!"
  foo = function.run read
  print "Echo:"
  print foo
}
