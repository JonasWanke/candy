core = use "..Core"
async = core.async
await = core.await
channel = core.channel
parallel = core.parallel
text = core.text

main := { environment ->
  print message =
    needs (text.is message)
    environment.stdout | channel.send message

  parallel { nursery ->
    nursery
    | async {
      print "Hello from fiber!"
      "Hello, async await!"
    }
    | await
    | print

    nursery | async { print "Kiwi" }
    nursery | async { print "Banana" }
    print "Hi"
  }
}
